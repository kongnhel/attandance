/**
 * á¢áŸ’á“á€á™á¶á˜á‘áŸ’áœá¶ášá€á˜áŸ’ášá·á Evolution V3 (Session Guard)
 * á†áŸ‚á€á˜á¾á›áá¶áá¾á¢áŸ’á“á€á”áŸ’ášá¾á”áŸ’ášá¶áŸáŸ‹á˜á¶á“ "áŸáŸ†á”á»ááŸ’ášá¢á“á»á‰áŸ’á‰á¶á" á€áŸ’á“á»á„ Session á¬á¢ááŸ‹
 */
const adminAuth = (req, res, next) => {
  // áŸ¡. á†áŸ‚á€á˜á¾á›áá¶ áá¾á€áŸ’á“á»á„ Session á˜á¶á“á€á¶ášá”á‰áŸ’á‡á¶á€áŸ‹áá¶á‡á¶ Admin á á¾á™á¬á“áŸ…?
  if (req.session && req.session.isAdmin) {
return next();
    } else {
        // ğŸ”¥ á€áŸ‚ááŸ’ášá„áŸ‹á“áŸáŸ‡áŸ– á”á‰áŸ’á‡á¼á“á‚á¶ááŸ‹á‘áŸ…á‘áŸ†á–áŸášá…á»áŸ‡áˆáŸ’á˜áŸ„áŸ‡ QR áœá·á‰á—áŸ’á›á¶á˜!
        return res.redirect('/manager/qr-reg'); 
    }
};

module.exports = adminAuth;
